---
uid: 20231225092825
title: 网络篇
tags: []
description: 
author: 西郊有密林
type: basic
draft: false
editable: false
modified: 20231225113528
---

# 网络篇

>[!question]
>1. 为什么我打不开插件市场？
>2. 为什么我下载主题的速度很慢？
>3. 大家都在说去一个叫做 github 的地方，为什么我打不开网址？
>4. ……

这些都是很常见的问题，是那种新人不懂，懂的人又懒得解释的问题。有时候并非是大家不愿意解释，而是解释起来感到鸡同鸭讲，所以没了兴趣。本文会尽量用最通俗的语言，帮助你了解一些必要的网络知识，让你可以自己判断分析一下自己的问题，另一方面也可以帮助你更好地定位问题，从而获取更加精准的帮助。

本人水平有限，文章存在错误还请斧正。如果你有兴趣，可以通过 [[fanghejin@qq.com|邮件]] 告知我你的意见。

# 网络总览

网络是个非常非常复杂的系统，不要指望自己可以从上到下理解其方方面面。为了理解，我们会把网络分成若干层次：

```mermaid
graph LR
应用层----运输层----网络层----链路层----物理层
```

这个层次模型并不是唯一的，甚至也不是最正统的 [^1]。你可能会在其他地方听说「七层模型」或者「四层模型」，还有可能会有同一层用不同名称的情况（比如运输层就经常也叫做传输层）。但是这对本文的目标没有影响，按照本文的说法理解就行了。

现在，想象你使用 QQ 向朋友发送了一条消息：

1. 处于**应用层**的 QQ 会把你的消息打包成适合网络传输的格式，然后你的消息会**从左到右**经过所有层的处理，最后抵达物理层，被转化为光缆的光信号，或者手机笔记本等无线设备的电磁波信号发送出去；
2. 信号抵达了朋友的电脑，先是从朋友电脑的**物理层**开始，**从右往左**经过所有层处理，最后抵达应用层，朋友的电脑中的 QQ 会把传输来的消息经过处理显示到朋友的面前。

这个发送消息的过程应该很好理解。我举这个例子是为了告诉你，其实不论你在网络上做什么，网络的传输基本上都遵循这个模型。比如

1. 网站上/app 上下载软件：一切软件都是二进制表示的，也就是说是一串极长的数字，所以发送软件和发送消息其实是完全一样的。你点击下载键这一消息会从左到右经过所有层进入网络，然后又从右到左经过所有层抵达网站服务器的电脑；网站服务器则把软件也经过一样的过程发送到你的设备里。
2. 发送邮件：邮件也类似 QQ 消息。
3. QQ 电话/视频：你的声音/视频被一边录制一边打包为同样的二进制数据，通过一样的过程，一边录制一边发送已经录制好的内容。
4. ……

所以说你其实可以把网络当成物流网络来理解。不论什么货物都会被打包为「包裹」，经过统一的运输流程抵达任何地方。因此，一切和网络有关的问题都可以分类为三个部分

1. 你的设备有问题
2. 网络运输系统有问题
3. 你的朋友的设备有问题

理解了这一些，我就可以根据一些经常见到的实际案例来告诉你如何解决问题了。

# 我打不开插件市场/主题市场/github

这三个问题其实是同一个问题，因为背后和你的计算机互发消息的「朋友」其实都是 github 的服务器。内置的插件市场、主题市场其实只是代替你筛选了 github 上的一部分内容显示在里面而已。

所以说如果你能顺利访问 github，那么另外两个也应该是没有问题的。如果还有，那就基本上可以判断问题出在 Obsidian 的软件本体上。可能是 Obsidian 被禁止使用网络，也可能是 Obsidian 文件有损坏了。这里面的原因仍然可能很复杂，但是往这方面想是对的。

然后就是最常见的问题：这三个我都打不开。

这个问题的根源一般在网络系统上面，但其具体原因我不能一概而论，甚至可以说其背后原因是动态变化的，只是表现出来的结果都是你无法访问这三个地方而已。当前文章写作时（2023 年 12 月 25 日），这些问题背后的原因主要是 DNS 污染 [^2]。

DNS（Domain Name System）域名系统。要理解这个概念我还得介绍一些基础知识。

## 域名、IP 地址

域名 [^3]，一句话说清楚，就是 `https://www.pkmer.cn` 这样的网址；IP 地址 [^4]，一句话说清楚，就是联网设备的独有地址，是类似 `127.0.0.1` 这样的一串数字。

刚才介绍了网络传输的模型，我们说网络上交流就好比之前用邮政的物流系统送信交流。那你有没有想过，邮政依靠你填的地址找到你的朋友，我们发出的网络消息是怎么从茫茫人海中找到你的朋友的设备的？

网络寻找你朋友的设备的「地址」就是 IP 地址。每一台联网设备在**同一个网络**里的 IP 地址必须是唯一的，就好比家庭住址必须是唯一的。但是如你所见，IP 地址这串数字不好记，所以为了方便才有了域名（Domain Name），用一串好记的字符代替难记的 IP 地址。寻找域名对应的 IP 地址的过程就叫做**域名解析**[^5]，以访问 pkmer 网站为例，域名解析是这样的：

1. 我想访问 pkmer 网站，我记得其域名 `https://www.pkmer.cn`，我把它输入浏览器试图访问
2. 浏览器在应用层，它需要知道域名对应的 IP 地址，于是就发送了一条消息询问**域名服务器**：`www.pkmer.cn` 对应的 IP 地址是什么呢？
3. 域名服务器发回了回答，于是浏览器知道了 pkmer 服务器的 IP 地址，可以通过上面的流程进行交流了。

至于为什么有了 IP 地址就可以从巨大的互联网找到容易一台设备，网络是如何把你的消息传输过去的，我可以告诉你这里涉及到一套微妙又复杂的去中心化机制，只依靠一群简单的、没有任何智能、只有简单收发消息功能路由器 [^6]，按照固定的程序转发你发送的消息，就能把你的消息转发到你的朋友那里，而且效率不低。不过这里先按下不表，谈安全的时候再了解这部分。

## DNS？污染？

有了上面的铺垫，你应该就能猜到，DNS 污染，其实就是域名解析的过程遭到了污染。可能是访问域名服务器的过程出了问题，也可能是域名服务器本身没有返回正确的 IP 地址。这背后的原因又是无比复杂，交织着各方的心思。不论如何，总之域名转换为 IP 地址的过程被打断了。

根据这个原理，一个显而易见的解决方案就是把IP地址记下来，不通过DNS解析就不会遭到DNS污染。



[^1]: [计算机网络的七层结构、五层结构和四层结构 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/350408610)
[^2]: [域名服务器缓存污染 - 维基百科](https://zh.wikipedia.org/wiki/%E5%9F%9F%E5%90%8D%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%93%E5%AD%98%E6%B1%A1%E6%9F%93)
[^3]: [什么是域名？域名的格式是什么? - username的回答 - 知乎](https://www.zhihu.com/question/537356799/answer/2526511558)
[^4]: [IP地址_百度百科 (baidu.com)](https://baike.baidu.com/item/IP%E5%9C%B0%E5%9D%80/150859)
[^5]: [域名解析_百度百科 (baidu.com)](https://baike.baidu.com/item/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/574285)
[^6]: [路由器（连接两个或多个网络的硬件设备）_百度百科 (baidu.com)](https://baike.baidu.com/item/%E8%B7%AF%E7%94%B1%E5%99%A8/108294)